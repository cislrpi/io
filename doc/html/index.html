<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>README</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>


</head>

<body>

<h1 id="toc_0">CELIO - Cognitive Environment Library for I/O</h1>

<!-- TOC depthFrom:1 depthTo:6 insertAnchor:false orderedList:false updateOnSave:true withLinks:true -->

<ul>
<li><a href="#celio-cognitive-environment-library-for-io">CELIO - Cognitive Environment Library for I/O</a>

<ul>
<li><a href="#setup">Setup</a></li>
<li><a href="#publish-and-subscribe">Publish and Subscribe</a>

<ul>
<li><a href="#publish">Publish</a></li>
<li><a href="#subscribe">Subscribe</a></li>
</ul></li>
<li><a href="#config">Config</a></li>
<li><a href="#transcript">Transcript</a>

<ul>
<li><a href="#switch-model">Switch model</a></li>
<li><a href="#stop-publishing">Stop publishing</a></li>
<li><a href="#add-keywords">Add keywords</a></li>
<li><a href="#tag-channel-with-speaker-name">Tag channel with speaker name</a></li>
</ul></li>
<li><a href="#speaker">Speaker</a>

<ul>
<li><a href="#volume-control">volume control</a>

<ul>
<li><a href="#speakerreducevolumechange">speaker.reduceVolume(change)</a></li>
<li><a href="#speakerincreasevolumechange">speaker.increaseVolume(change)</a></li>
</ul></li>
</ul></li>
<li><a href="doc/Display.md">Display</a>

<ul>
<li><a href="doc/Display.md">Basics</a></li>
<li>API Reference

<ul>
<li><a href="doc/displayfactory.md"><code>io.displayContext</code></a></li>
<li><a href="doc/displaycontext.md">DisplayContext</a></li>
<li><a href="doc/window.md">Window</a></li>
<li><a href="doc/viewobject.md">ViewObject</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<!-- /TOC -->

<h2 id="toc_1">Setup</h2>

<p>This package is hosted on our private npm registry. Ask us for user name and password. To install it, do the following:
<code>
npm config set registry https://cel-npm-registry.mybluemix.net/
npm login
npm install celio
</code></p>

<p>To use it in nodejs:
<code>js
var CELIO = require(&#39;celio&#39;);
var io = new CELIO();
</code></p>

<p>For now, you need to have a cog.json file in your package directory, with the following fields:
<code>json
{
  &quot;mq&quot;: {
    &quot;url&quot;: &quot;rabbitmq host&quot;,
    &quot;username&quot;: &quot;username&quot;,
    &quot;password&quot;: &quot;password&quot;
  }
}
</code></p>

<p>You don&#39;t need the <code>mq</code> configuration if you&#39;re just hosting a webpage. For all other stuff, you need the <code>mq</code> configuration.
This configuration object has username and password in it, so please don&#39;t share it with others and don&#39;t commit it to your repository.
Your applications can only communicate with each other if they use the same exchange.</p>

<p>To use it in the browser with webpack or other compilers:
<code>js
var CELIO = require(&#39;celio/lib/client&#39;);
var io = new CELIO({
  &quot;mq&quot;: {
    &quot;url&quot;: &quot;rabbitmq host&quot;,
    &quot;username&quot;: &quot;username&quot;,
    &quot;password&quot;: &quot;password&quot;
  }
})
</code></p>

<h2 id="toc_2">Central Server Setup</h2>

<p>If you need to set up a central server for your environment, please follow the installation instructions <a href="doc/CELIO%20central%20server%20setup.md">here</a></p>

<h2 id="toc_3">Publish and Subscribe</h2>

<p>With the io object, you can publish and subscribe to raw messages with the following functions:</p>

<h3 id="toc_4">Publish</h3>

<div><pre><code class="language-javascript">io.publishTopic(topic, content, options);</code></pre></div>

<h3 id="toc_5">Subscribe</h3>

<div><pre><code class="language-javascript">io.onTopic(topic, function(content, headers){
  // handle messages
  var msg = JSON.parse(content.toString());
});</code></pre></div>

<p>In <code>publishTopic</code>, you can use options to specify a header for the message.
See <a href="http://www.squaremobius.net/amqp.node/channel_api.html#channel_publish">amqp.node</a> for how to use the header.</p>

<p>The topic should have the following format subType.minorType.majorType.
Our convention is to use the topic to declare the message type, and the type should be from more specific to less specific.
For command messages, we always have the &#39;command&#39; as the last component of the topic tag. e.g., stop.speaker.command.
For other events, we have something like closeMic.final.transcript or wand.absolute.pointing.</p>

<p>To subscribe events, the topic can include wildcards <code>*</code> and <code>#</code>. <code>*</code> substitues one word, <code>#</code> substitues multiple words.
For example, <code>*.absolute.pointing</code> subscribes to wand.absolute.pointing and lighthouse.absolute.pointing, whereas <code>#.pointing</code> also subscribes to them plus other pointing events like mouse.relative.pointing.</p>

<p>In <code>publishTopic</code>, the message can be of type string, Buffer, ArrayBuffer, Array, or array-like objects. We recommand that you use JSON strings.</p>

<h2 id="toc_6">Config</h2>

<p>The <code>cog.json</code> file is parsed and saved as a <code>io.config</code> object, so that you can query any configurations with the following function:
<code>js
io.config.get(&#39;rootKey:nestedKey&#39;);
</code>
The config object also reads in command line arguments and environment variables.
For environment variables, replace &quot;:&quot; with &quot;_&quot;. 
You can use command line arguments to override settings in the cog.json file to temporarily switch exchanges for example.</p>

<p>We use the <a href="https://github.com/indexzero/nconf">nconf</a> to do this.
For more information about the config object, you can read the nconf documentation. </p>

<h2 id="toc_7">Transcript</h2>

<p>The transcript object has three functions for subscribing to transcripts: <code>onFinal</code>, <code>onInterim</code>, <code>onAll</code>.
<code>onFinal</code> subscribes to only the full sentences.
<code>onInterim</code> subscribes to only the interim results.
<code>onAll</code> subscribes to both.
<code>js
var transcript = io.getTranscript();
transcript.onFinal(function(msg, headers) {
    // Do your thing here
    var sentence = msg.result.alternatives[0].transcript;
    // For the most part, you don&#39;t need fields and properties
});
</code> 
The <code>msg</code> object has at least the following fields:
<code>js
{
  workerID: &quot;id&quot;,
  channelIndex: num,
  speaker: &quot;speaker name(optional)&quot;,
  result: {
    alternatives: [{transcript: &quot;message&quot;, confidence: 0.9}],
    final: true,
    keyword_result: {}
  },
  messageID: &quot;uuid string&quot;
  time_captured: unix_time
}
</code>
The result field follows the definition of Watson STT.
The full specification can be seen on <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/doc/speech-to-text/output.shtml">Watson STT website</a>.</p>

<p>The transcript object supports a few other features:</p>

<h3 id="toc_8">Switch model</h3>

<div><pre><code class="language-javascript">transcript.switchModel(&#39;model name&#39;);</code></pre></div>

<h3 id="toc_9">Stop publishing</h3>

<div><pre><code class="language-javascript">transcript.stopPublishing();</code></pre></div>

<h3 id="toc_10">Add keywords</h3>

<div><pre><code class="language-javascript">transcript.addKeywords(words) // words is an array of strings</code></pre></div>

<h3 id="toc_11">Tag channel with speaker name</h3>

<div><pre><code class="language-javascript">transcript.tagChannel(workerID, channelIndex, speaker_name);</code></pre></div>

<h2 id="toc_12">Speaker</h2>

<p>The Speaker object allows you to pass text to Text-to-Speech worker to speak.
<code>javascript
var speaker = io.getSpeaker();
speaker.speak(&#39;Hi you&#39;);
</code>
Optionally, you can specify TTS voices in the second parameter to the function, e.g., <code>speaker.speak(&#39;Hi&#39;, {voice:&#39;en-US_AllisonVoice&#39;})</code>.
For a full list of voice you can use, check <a href="http://www.ibm.com/watson/developercloud/doc/text-to-speech/http.shtml#voices">Watson TTS website</a>.
You can also use SSML. Again, check <a href="http://www.ibm.com/watson/developercloud/doc/text-to-speech/http.shtml#input">Watson TTS website</a>.</p>

<p>If you want to subscribe to speaking events, you can use <code>onBeginSpeak</code> and <code>onEndSpeak</code>. <code>onBeginSpeak</code> will give you the message that is spoken. </p>

<p>You can also interrupt the speaker by calling <code>stop</code>.</p>

<h3 id="toc_13">volume control</h3>

<h4 id="toc_14">speaker.reduceVolume(change)</h4>

<h4 id="toc_15">speaker.increaseVolume(change)</h4>

<p>Volume is from 0 to 100.</p>

<h2 id="toc_16">RPC</h2>

<h3 id="toc_17">io.call(queue, content, options)</h3>

<p><em>queue</em> is the queue name, <em>content</em> is the RPC parameter.
This funciton returns a promise that contains the result or error of the RPC.</p>

<h3 id="toc_18">doCall(queue, handler, noAck=true, exclusive=true)</h3>

<p><em>handler</em> has the following sigature:
<code>handler(request, reply, ack)</code>.
<em>request</em> is an object with three fields <em>content</em>, <em>field</em>, <em>properties</em>. Use content to get the message sent by the client.
<em>reply</em> is a function. Use it to send a message back to the caller.
<em>ack</em> is the acknowledge function, and will only be provided if noAck is set to false. Normally you don&#39;t need this.</p>

<p>Again, <em>queue</em> is the queue name, handler is a callback function that handles the RPC call.
The <em>reply</em> function accepts a string, a Buffer, an ArrayBuffer, an Array, an array-like object, or an Error object.
We recommand that you use JSON strings.
If an Error object is used, it will trigger an exception in the caller site.</p>

<p>The <em>reply</em> function should only be called once.</p>

<h2 id="toc_19">Setting up a rabbitmq server</h2>

<p>Please follow the installation guide here:
https://www.rabbitmq.com/download.html</p>




</body>

</html>
